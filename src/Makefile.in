#
# builds substation related programs

# Compile c++ source code
.SUFFIXES:.cpp

prefix=@prefix@
exec_prefix=@exec_prefix@

BASEDIR=../
XREFDIR=${BASEDIR}/xref/
UDATAOBJ=$(BASEDIR)/udataobj/
BINDIR=$(BASEDIR)/bin/
APPDIR=$(BASEDIR)/app/
INCDIR=$(BASEDIR)/include/
LIBDIR=$(BASEDIR)/lib/
LOCALEDIR=${BASEDIR}/locale

CC=@CC@
CCC=@CXX@
CXX=$CCC
RANLIB=@RANLIB@
AR=@AR@ @ARFLAGS@

INSTALL=@INSTALL@
RM=@RM@
MV=@MV@
LN_S=@LN_S@
MKDIR=@MKDIR_P@

BITS=@BITS@
OBJECT_MODE=$(BITS)
LIBS=@LIBS@

CXXFLAGS=@CXXFLAGS@
CFLAGS=@CFLAGS@
CPPFLAGS=@CPPFLAGS@

LDFLAGS=@LDFLAGS@
LIBS=@LIBS@

OBJECTS=@OBJECTS@

LIBPTHREAD=lib@PACKAGE_NAME@.a

all:${LIBPTHREAD}

lib@PACKAGE_NAME@.a: $(OBJECTS)
	${AR} ${LIBDIR}/$@ $(OBJECTS)
	$(RANLIB) ${LIBDIR}/$@

globber: clean
	-$(RM) -R Makefile autom4te.cache config.log config.status 

clean:
	${RM} *.o core *.a
	cd $(LIBDIR) && ${RM} lib@PACKAGE_NAME@* 

cxref:
	cxref *.c -xref -index-all -latex209 -O${XREFDIR} -I${INCDIR} -I${INCTUX}

install:
	$(MKDIR) @includedir@/pthread
	$(INSTALL) ${INCDIR}/pthread/*.hpp ${INCDIR}/pthread/*.h @includedir@/pthread
	$(INSTALL) ${LIBDIR}/lib@PACKAGE_NAME@.a @libdir@

uninstall:
	$(RM) -R  @includedir@/pthread
	$(RM) @libdir@/lib@PACKAGE_NAME@*.a

# cpp build rule
.cpp.o:
	$(CCC) $(CPPFLAGS) $(CXXFLAGS) $(CFLAGS) -c $<

.cpp:
	$(CCC) $(CPPFLAGS) $(CXXFLAGS) $(CFLAGS) $< -o $@ $(LDFLAGS) $(LIBS)
